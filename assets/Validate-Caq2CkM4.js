import{p as $,I,r as f,c as S,J as z,a as C,o,e as v,h as a,n as m,b as U,d as V,w as t,K as g,V as H,l as R,E as j,B as q,H as h,F as B,j as x,q as A,s as J,f as K}from"./index-DHeQaB2E.js";import{_ as M,a as D}from"./IssueHeading-BNneYwW5.js";import{V as P}from"./VFileInput-Cs2XP692.js";const G={class:"validate"},O={style:{"padding-right":"0.5em","font-weight":"600"}},Q={__name:"Validate",setup(W){const b=I(),p=f([]),d=f([]),y=f(!1),k=f(!1),_=f(!1),c=f(""),w=z("$libcellml"),E=S(()=>w.status==="ready"&&d.value.size>0?void 0:!0);function F(i){p.value.splice(i,1)}function T(i){let e=new w.library.Parser(!0),l=new w.library.Validator,s=null;try{s=e.parseModel(i)}catch(r){return e.delete(),l.delete(),{issues:[{description:"Error encountered while parsing file.  Error: "+r.message}],type:"parser"}}let n=[],u=0;if(e.errorCount()){for(;u<e.errorCount();){let r=e.error(u);n.push({description:r.description()}),r.delete(),u++}return e.delete(),l.delete(),s.delete(),{issues:n,type:"parser"}}for(u=0,l.validateModel(s);u<l.errorCount();){let r=l.error(u);n.push({description:r.description(),ref:r.referenceHeading(),url:r.url()}),r.delete(),u++}return k.value=n.length>0,e.delete(),l.delete(),s.delete(),{issues:n,type:"validator"}}function L(){k.value=!1,y.value=!1,c.value="",p.value=[]}function N(){L();const i=new FileReader;i.readAsText(d.value,"UTF-8"),i.onload=function(e){try{let l=T(e.target.result);c.value=d.value.name,p.value=l.issues,_.value=!!(l.type==="parser"&&l.issues.length),y.value=!!(l.type==="validator"&&l.issues.length)}catch(l){_.value=!0,b.add({type:"error",title:"File read error:",message:"Could not validate file: "+l.message})}},i.onerror=function(e){b.add({type:"error",title:"File read error:",message:d.name})}}return(i,e)=>(o(),C("div",G,[e[7]||(e[7]=v("h1",null,"Validate CellML models",-1)),e[8]||(e[8]=v("p",null,[V(" This service will accept CellML 2.0 files and check for syntactic validity against the "),v("a",{href:"https://www.cellml.org/specifications/cellml_2.0",target:"_blank"},"CellML Normative Specification")],-1)),a(g,null,{default:t(()=>[a(P,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value=l),"show-size":"","truncate-length":"64",label:"Upload model"},{default:t(()=>[...e[1]||(e[1]=[V(" >",-1)])]),_:1},8,["modelValue"])]),_:1}),a(g,null,{default:t(()=>[a(H,{justify:"center"},{default:t(()=>[a(R,{class:"col-12 col-md-4",id:"validateButton"},{default:t(()=>[a(j,{block:"",class:q("big-button"),disabled:E.value,onClick:N},{default:t(()=>[a(h,{color:"white","x-large":""},{default:t(()=>[...e[2]||(e[2]=[V("mdi-file-check-outline",-1)])]),_:1}),e[3]||(e[3]=v("br",null,null,-1)),e[4]||(e[4]=V(" Validate CellML 2.0 syntax ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),_.value?(o(),m(g,{key:0},{default:t(()=>[a(M,{title:c.value},null,8,["title"]),(o(!0),C(B,null,x(p.value,(l,s)=>(o(),m(D,{key:"parser_issue_"+s,issue:l,onDismiss:n=>F(s)},null,8,["issue","onDismiss"]))),128))]),_:1})):y.value?(o(),m(g,{key:1},{default:t(()=>[a(M,{title:c.value,issueSource:"Validation"},null,8,["title"]),(o(!0),C(B,null,x(p.value,(l,s)=>(o(),m(D,{key:"validation_issue_"+s,issue:l,onLearnButton:!0,onDismiss:n=>F(s)},null,8,["issue","onDismiss"]))),128))]),_:1})):!_.value&&!y.value&&c.value?(o(),m(g,{key:2},{default:t(()=>[a(A,{class:"noErrors",elevation:"0"},{default:t(()=>[a(J,null,{default:t(()=>[a(h,{large:""},{default:t(()=>[...e[5]||(e[5]=[V("mdi-check-bold",-1)])]),_:1}),v("span",O,K(c.value)+":",1),e[6]||(e[6]=v("span",null,"The model is valid!",-1))]),_:1})]),_:1})]),_:1})):U("",!0)]))}},ee=$(Q,[["__scopeId","data-v-90ee9651"]]);export{ee as default};
