import{p as $,I as S,r as c,c as z,J as E,a as g,o as i,e as v,h as t,n as C,b as P,w as s,K as b,d,V as R,l as U,E as F,B as j,H as q,q as A,N as G,S as H,F as M,j as _,D as J,L as K,G as O,i as k}from"./index-Ch7Pi2nU.js";import{_ as Q,a as W}from"./IssueHeading-CJvOmtuK.js";import{V as X,a as Y,d as Z,b as h}from"./VFileInput-C5wZufFL.js";const ee={class:"import"},le={__name:"Import",setup(te){const y=S(),u=c([]),o=c([]),w=c(!1),p=c([]),V=E("$libcellml"),I=z(()=>V.status==="ready"?o.value.size>0:!1);function L(r){u.value.splice(r,1)}function x(r){let e=new V.library.Parser(!1),l=new V.library.Printer,a=null;try{a=e.parseModel(r)}catch(f){return e.delete(),l.delete(),{issues:[{description:"Failed to parse model.  Reason:"+f.message}],type:"parser"}}let n=[],m=0;if(e.errorCount()){for(;m<e.errorCount();){let f=e.error(m);n.push({description:f.description()}),f.delete(),m++}return e.delete(),l.delete(),a.delete(),{issues:n,type:"parser"}}const N=l.printModel(a,!1);return p.value.push({name:o.value.name,data:N,type:"text/xml",pending:!1}),e.delete(),l.delete(),a.delete(),{issues:n,type:"not-set"}}function B(){u.value=[]}function D(){p.value=[]}function T(){B();const r=new FileReader;r.readAsText(o.value,"UTF-8"),r.onload=function(e){try{let l=x(e.target.result);u.value=l.issues,w.value=!!(l.type==="parser"&&l.issues.length)}catch(l){y.add({type:"error",title:"File read error:",message:"Could not validate file: "+l.message})}},r.onerror=function(e){y.add({type:"error",title:"File read error:",message:o.name})}}return(r,e)=>(i(),g("div",ee,[e[9]||(e[9]=v("h1",null,"Import CellML models",-1)),e[10]||(e[10]=v("p",null," This service will accept CellML 1.0 or CellML 1.1 files and import them into CellML 2.0 by parsing them using libCellML in permissive mode. ",-1)),t(b,null,{default:s(()=>[t(X,{id:"import-file-input",modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value=l),"show-size":"","truncate-length":"64",label:"Upload model"},{default:s(()=>[...e[2]||(e[2]=[d(" >",-1)])]),_:1},8,["modelValue"])]),_:1}),t(b,null,{default:s(()=>[t(R,{justify:"center"},{default:s(()=>[t(U,{class:"col-12 col-md-4",id:"importButton"},{default:s(()=>[t(F,{block:"",class:j("big-button"),disabled:!I.value,onClick:T},{default:s(()=>[t(q,{color:"white","x-large":""},{default:s(()=>[...e[3]||(e[3]=[d("mdi-file-import",-1)])]),_:1}),e[4]||(e[4]=v("br",null,null,-1)),e[5]||(e[5]=d(" Import CellML 1.0/1.1 model ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),t(b,null,{default:s(()=>[t(A,{class:"mx-auto"},{default:s(()=>[t(G,{rounded:""},{default:s(()=>[t(H,null,{default:s(()=>[e[7]||(e[7]=d("Imported models",-1)),t(Y),t(F,{class:"import-clear-btn",disabled:p.value.length===0,onClick:e[1]||(e[1]=l=>D())},{default:s(()=>[...e[6]||(e[6]=[d("clear",-1)])]),_:1},8,["disabled"])]),_:1}),(i(!0),g(M,null,_(p.value,(l,a)=>(i(),C(J,{bottom:"",key:a},{activator:s(({props:n})=>[t(K,O({ref_for:!0},n,{onClick:m=>k(h)(l),disabled:l.pending,"prepend-icon":l.pending?"mdi-loading":"mdi-download",title:k(Z)(l)}),null,16,["onClick","disabled","prepend-icon","title"])]),default:s(()=>[e[8]||(e[8]=v("span",null,"Download",-1))]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),w.value?(i(),C(b,{key:0},{default:s(()=>[t(Q,{title:o.value.name},null,8,["title"]),(i(!0),g(M,null,_(u.value,(l,a)=>(i(),C(W,{key:a,issue:l,onDismiss:n=>L(a)},null,8,["issue","onDismiss"]))),128))]),_:1})):P("",!0)]))}},oe=$(le,[["__scopeId","data-v-4bab1e8c"]]);export{oe as default};
